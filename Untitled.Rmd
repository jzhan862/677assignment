---
title: "assignment"
output: word
author:Jinzhe Zhang
---


---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)


# For this assignment I consult with Shenhao
```



## Reach to the conclusion

```{r}
n = 100
m = c(60, 70, 80, 90)
p = seq(0.4, 1, 1/n)
for (i in m) {
  if (i == m[1]) {
    P = data.frame(p, Cured=paste('P',i,sep=''),
                   Power=cumsum(dbinom(i,n,p))
                   )
  }
  else {
    P = rbind(P, data.frame(p, Cured=paste('P',i,sep=''),
                            Power=cumsum(dbinom(i,n,p))
                            )
              )
  }
}
ggplot()+
  geom_rect(aes(xmin = 0.6, xmax = 0.8, ymin = 0.05, ymax = 0.95), alpha = 0.5)+
  geom_line(aes(p, Power, color = Cured), P)+
  labs(title = 'Power curves with different critical values')



```
With total 100 sample size, the larger m will move the curve to further right. The bottom and top lines of the box represent the 5% type 1 error and (1-95%) type 2 error.we need to find the line with samllest m cross the bottom of the box and the line(blue) with largest m across with the top of the box. 

## Replicate and explain Figure 3.7

```{r}
n = 100
m = c(69,73)
p = seq(0.4, 1, 0.01)
for (i in m) {
  if (i == m[1]) {
    P = data.frame(p, Cured=paste('P',i,sep=''),
                   Power=cumsum(dbinom(i,n,p))
                   )
  }
  else {
    P = rbind(P, data.frame(p, Cured=paste('P',i,sep=''),
                            Power=cumsum(dbinom(i,n,p))
                            )
              )
  }
}
ggplot()+
  geom_rect(aes(xmin = 0.6, xmax = 0.8, ymin = 0.05, ymax = 0.95), alpha = 0.5)+
  geom_line(aes(p, Power, color = Cured), P)+
  labs(title = 'Figure 3.7: The power curve')
  
```

  I find the line (red) with samllest m=69 cross the bottom of the box and the line(blue) with largest m=73 across with the top of the box. Between 69 and 73 is reliable.
